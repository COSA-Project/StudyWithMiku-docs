(self.webpackChunkTopWritePlugins_knowledge=self.webpackChunkTopWritePlugins_knowledge||[]).push([[272],{5272:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var n=r(9221),a=r.n(n),o=r(4685),i=r.n(o),s=r(8823),c=r.n(s),u=(r(6767),r(1675),r(3708),r(914),r(7802),r(9507),r(3279),r(2378),r(4099)),l=r(9196);function f(e){let t,r,n,a=!1;return function(o){void 0===t?(t=o,r=0,n=-1):t=function(e,t){const r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}(t,o);const i=t.length;let s=0;for(;r<i;){a&&(10===t[r]&&(s=++r),a=!1);let o=-1;for(;r<i&&-1===o;++r)switch(t[r]){case 58:-1===n&&(n=r-s);break;case 13:a=!0;case 10:o=r}if(-1===o)break;e(t.subarray(s,o),n),s=r,n=-1}s===i?t=void 0:0!==s&&(t=t.subarray(s),r-=s)}}var d=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r};const v="text/event-stream",p=1e3,h="last-event-id";function g(e,t){var{signal:r,headers:n,onopen:a,onmessage:o,onclose:i,onerror:s,openWhenHidden:c,fetch:u}=t,l=d(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise(((t,d)=>{const g=Object.assign({},n);let y;function w(){y.abort(),document.hidden||$()}g.accept||(g.accept=v),"undefined"==typeof document||c||document.addEventListener("visibilitychange",w);let m=p,x=0;function k(){"undefined"==typeof document||c||document.removeEventListener("visibilitychange",w),clearTimeout(x),y.abort()}null==r||r.addEventListener("abort",(()=>{k(),t()}));const O=null!=u?u:fetch,W=null!=a?a:b;async function $(){var r;y=new AbortController;try{const r=await O(e,Object.assign(Object.assign({},l),{headers:g,signal:y.signal}));await W(r),await async function(e,t){const r=e.getReader();let n;for(;!(n=await r.read()).done;)t(n.value)}(r.body,f(function(e,t,r){let n={data:"",event:"",id:"",retry:void 0};const a=new TextDecoder;return function(o,i){if(0===o.length)null==e||e(n),n={data:"",event:"",id:"",retry:void 0};else if(i>0){const e=a.decode(o.subarray(0,i)),s=i+(32===o[i+1]?2:1),c=a.decode(o.subarray(s));switch(e){case"data":n.data=n.data?n.data+"\n"+c:c;break;case"event":n.event=c;break;case"id":null==t||t(n.id=c);break;case"retry":const e=parseInt(c,10);isNaN(e)||null==r||r(n.retry=e)}}}}(o,(e=>{e?g[h]=e:delete g[h]}),(e=>{m=e})))),null==i||i(),k(),t()}catch(e){if(!y.signal.aborted)try{const t=null!==(r=null==s?void 0:s(e))&&void 0!==r?r:m;clearTimeout(x),x=setTimeout($,t)}catch(e){k(),d(e)}}}$()}))}function b(e){const t=e.headers.get("content-type");if(!(null==t?void 0:t.startsWith(v)))throw new Error(`Expected content-type to be ${v}, Actual: ${t}`)}var y=r(7265),w=r(571),m=r.n(w);function x(e){var t=e.children,r=(0,u.useActions)("search").setHandler,n=(0,u.useActions)("ask").setHandler,o=(0,u.useBook)().summary,s=(0,u.useInPreview)(),f=(0,y.zP)(),d=(0,u.useFile)(),p=(0,u.useModel)("page"),h=i()(p,2),b=h[0].lfs,w=h[1],x=w.intercept,k=w.fetch;(0,u.useAsyncEffect)(a()(c().mark((function e(){var t,o,i,l,f;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=17;break}return t=location.pathname,o=t.endsWith("/")?t:m().dirname(t),i=m().resolve(o,d.relative("/")),e.prev=4,l=m().join(i,"search"),e.next=8,u.request.head(l);case 8:return r(function(){var e=a()(c().mark((function e(t,r){var n,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.request.post(m().join(i,"search"),{keyword:t,part:r});case 3:return n=e.sent,a=n.data,e.abrupt("return",a);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",[]);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,r){return e.apply(this,arguments)}}()),f=m().join(i,"ask"),e.next=12,u.request.head(f);case 12:n((function(e,t){return new Promise((function(r,n){var o=new TransformStream,i=o.readable,s=o.writable,u=i.getReader(),l=s.getWriter(),d=!1;g(f,{method:"POST",body:JSON.stringify({keyword:e,part:t}),headers:{"Content-Type":"application/json"},onopen:function(e){return a()(c().mark((function t(){var a;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.ok&&null!==(a=e.headers.get("content-type"))&&void 0!==a&&a.startsWith(v)&&200===e.status?r(u):(d=!0,n());case 1:case"end":return t.stop()}}),t)})))()},onmessage:function(e){return a()(c().mark((function t(){var r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("[DONE]"!==e.data&&!d){t.next=3;break}return d=!0,t.abrupt("return");case 3:return t.prev=3,r=JSON.parse(e.data),t.next=7,l.write(r);case 7:t.next=11;break;case 9:t.prev=9,t.t0=t.catch(3);case 11:case"end":return t.stop()}}),t,null,[[3,9]])})))()},onclose:function(){return a()(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=!0,e.next=3,l.close();case 3:case"end":return e.stop()}}),e)})))()},openWhenHidden:!0})}))})),e.next=17;break;case 15:e.prev=15,e.t0=e.catch(4);case 17:case"end":return e.stop()}}),e,null,[[4,15]])}))),[]);var O=(0,l.useMemo)((function(){return o.getArticle((function(e){return e.getPath()===d.path}))||"index.html"===d.path}),[d]);return(0,l.useEffect)((function(){if(b&&f.setLfsFiles(b.files),x((function(e){e.request.use(f.interceptRequest())})),O)void 0===d.content&&k(u.history.location.pathname);else{var e=f.resolveBook(d.path);if(e){var t=o.getArticle((function(){return!0}),(function(t){return t.getMetadata("reference")===e}));if(t)return void u.history.replace(d.relative(t.path))}u.history.replace(d.relative("/"))}}),[]),O?t:null}},2906:(e,t,r)=>{"use strict";var n=r(1612).charAt;e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},9128:(e,t,r)=>{"use strict";r(3279);var n=r(8358),a=r(2841),o=r(8737),i=r(4350),s=r(5360),c=r(4542),u=s("species"),l=RegExp.prototype;e.exports=function(e,t,r,f){var d=s(e),v=!i((function(){var t={};return t[d]=function(){return 7},7!=""[e](t)})),p=v&&!i((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[u]=function(){return r},r.flags="",r[d]=/./[d]),r.exec=function(){return t=!0,null},r[d](""),!t}));if(!v||!p||r){var h=n(/./[d]),g=t(d,""[e],(function(e,t,r,a,i){var s=n(e),c=t.exec;return c===o||c===l.exec?v&&!i?{done:!0,value:h(t,r,a)}:{done:!0,value:s(r,t,a)}:{done:!1}}));a(String.prototype,e,g[0]),a(l,d,g[1])}f&&c(l[d],"sham",!0)}},2355:(e,t,r)=>{var n=r(7072),a=r(4292),o=Math.floor,i=n("".charAt),s=n("".replace),c=n("".slice),u=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,l=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,r,n,f,d){var v=r+e.length,p=n.length,h=l;return void 0!==f&&(f=a(f),h=u),s(d,h,(function(a,s){var u;switch(i(s,0)){case"$":return"$";case"&":return e;case"`":return c(t,0,r);case"'":return c(t,v);case"<":u=f[c(s,1,-1)];break;default:var l=+s;if(0===l)return a;if(l>p){var d=o(l/10);return 0===d?a:d<=p?void 0===n[d-1]?i(s,1):n[d-1]+i(s,1):a}u=n[l-1]}return void 0===u?"":u}))}},9147:(e,t,r)=>{var n=r(3133),a=r(6749),o=r(7938),i=r(41),s=r(8737),c=TypeError;e.exports=function(e,t){var r=e.exec;if(o(r)){var u=n(r,e,t);return null!==u&&a(u),u}if("RegExp"===i(e))return n(s,e,t);throw c("RegExp#exec called on incompatible receiver")}},6767:(e,t,r)=>{"use strict";var n,a=r(6958),o=r(8358),i=r(7583).f,s=r(9334),c=r(1533),u=r(2549),l=r(7516),f=r(347),d=r(9371),v=o("".endsWith),p=o("".slice),h=Math.min,g=f("endsWith");a({target:"String",proto:!0,forced:!!(d||g||(n=i(String.prototype,"endsWith"),!n||n.writable))&&!g},{endsWith:function(e){var t=c(l(this));u(e);var r=arguments.length>1?arguments[1]:void 0,n=t.length,a=void 0===r?n:h(s(r),n),o=c(e);return v?v(t,o,a):p(t,a-o.length,a)===o}})},2378:(e,t,r)=>{"use strict";var n=r(1329),a=r(3133),o=r(7072),i=r(9128),s=r(4350),c=r(6749),u=r(7938),l=r(2464),f=r(7752),d=r(9334),v=r(1533),p=r(7516),h=r(2906),g=r(2380),b=r(2355),y=r(9147),w=r(5360)("replace"),m=Math.max,x=Math.min,k=o([].concat),O=o([].push),W=o("".indexOf),$=o("".slice),E="$0"==="a".replace(/./,"$0"),S=!!/./[w]&&""===/./[w]("a","$0");i("replace",(function(e,t,r){var o=S?"$":"$0";return[function(e,r){var n=p(this),o=l(e)?void 0:g(e,w);return o?a(o,e,n,r):a(t,v(n),e,r)},function(e,a){var i=c(this),s=v(e);if("string"==typeof a&&-1===W(a,o)&&-1===W(a,"$<")){var l=r(t,i,s,a);if(l.done)return l.value}var p=u(a);p||(a=v(a));var g=i.global;if(g){var w=i.unicode;i.lastIndex=0}for(var E=[];;){var S=y(i,s);if(null===S)break;if(O(E,S),!g)break;""===v(S[0])&&(i.lastIndex=h(s,d(i.lastIndex),w))}for(var j,P="",A=0,T=0;T<E.length;T++){for(var M=v((S=E[T])[0]),I=m(x(f(S.index),s.length),0),R=[],q=1;q<S.length;q++)O(R,void 0===(j=S[q])?j:String(j));var H=S.groups;if(p){var N=k([M],R,I,s);void 0!==H&&O(N,H);var C=v(n(a,void 0,N))}else C=b(M,s,I,R,H,a);I>=A&&(P+=$(s,A,I)+C,A=I+M.length)}return P+$(s,A)}]}),!!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!E||S)},9507:(e,t,r)=>{"use strict";var n,a=r(6958),o=r(8358),i=r(7583).f,s=r(9334),c=r(1533),u=r(2549),l=r(7516),f=r(347),d=r(9371),v=o("".startsWith),p=o("".slice),h=Math.min,g=f("startsWith");a({target:"String",proto:!0,forced:!!(d||g||(n=i(String.prototype,"startsWith"),!n||n.writable))&&!g},{startsWith:function(e){var t=c(l(this));u(e);var r=s(h(arguments.length>1?arguments[1]:void 0,t.length)),n=c(e);return v?v(t,n,r):p(t,r,r+n.length)===n}})}}]);
//# sourceMappingURL=272-70af63.js.map