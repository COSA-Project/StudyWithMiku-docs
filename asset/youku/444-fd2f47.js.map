{"version":3,"file":"444-fd2f47.js","mappings":"yJAkBc,SAAUA,IACpB,MAAM,OAAEC,IAAWC,EAAAA,EAAAA,WAEnB,OAVE,SAA0BD,GAE5B,MAAME,EAASC,EAAQ,KAEvB,OAAOH,EAAOI,gBAAgBC,QAAaH,EAC/C,CAKWE,CAAgBJ,EAC3B,C,4ECtBA,MAAMM,EAAU,sB,aCqBhB,IAAIC,EAAO,EACPC,GAAS,EAEC,SAAUC,EAAKC,GAAmD,IAAhDC,OAAO,MAAEC,IAAuCF,EAC5E,MAAMV,GAASD,EAAAA,EAAAA,MACRc,EAAOC,IAAYC,EAAAA,EAAAA,UAAgB,CACtCC,MAAO,EACPC,OAAQ,EACRC,QAAQ,IAGNC,GAAKC,EAAAA,EAAAA,UAAQ,IAAM,YAAWb,GAAQ,IAqC5C,OAnCAc,EAAAA,EAAAA,YAAU,KACDb,IACDA,GAAS,GACTc,EAAAA,EAAAA,QAAO,iCAAkC,UAG7CA,EAAAA,OAAAA,MAAa,SAAS,KAClB,IAAI,GAAEH,EAAE,MAAEH,EAAK,OAAEC,EAAM,SAAEM,GDvCvB,SAAuBC,GACjC,IAGIR,EAAOC,GAFNE,EAAII,GAAYC,EAAKC,OAAOC,MAAM,MACnCC,EAASrB,EAAQsB,KAAKT,GAS1B,OANIQ,IACAR,EAAKQ,EAAO,GACZX,EAAQa,SAASF,EAAO,KAAO,OAC/BV,EAASY,SAASF,EAAO,KAAO,QAG7B,CAAER,KAAIH,QAAOC,SAAQM,WAChC,CC0BkDO,CAAalB,GAE/CmB,EAA4B,CAC5BC,IAAKb,GAGTI,IAAaQ,EAAQR,SAAWA,GAEhCQ,EAAUE,OAAOC,OAAO,CACpBC,QAAS,IACTC,UAAW,mBACXC,WAAW,GACZrC,EAAOsC,YAAaP,GAGnBjB,EADAE,GAASC,EACA,CAAED,QAAOC,SAAQC,QAAQ,EAAMa,WAE/B,CAAEf,MAAO,OAAQC,OAAQ,OAAQC,QAAQ,EAAOa,W,GAE/D,GACH,CAACnB,KAEJS,EAAAA,EAAAA,YAAU,KACFR,EAAMkB,SACN,IAAIQ,OAAOC,IAAIC,OAAOtB,EAAIN,EAAMkB,Q,GAErC,CAAClB,EAAMkB,WAEHW,EAAAA,EAAAA,KAAAC,EAAAA,SAAA,CAAAC,SACF/B,EAAMK,QAASwB,EAAAA,EAAAA,KAAA,OAAKvB,GAAIA,EAAI0B,MAAO,CAC5B7B,MAAOH,EAAMG,MACbC,OAAQJ,EAAMI,WAElByB,EAAAA,EAAAA,KAAA,OAAKG,MAAO,CAAEC,SAAU,WAAY9B,MAAO,OAAQC,OAAQ,EAAG8B,cAAe,UAAUH,UACnFF,EAAAA,EAAAA,KAAA,OAAKvB,GAAIA,EAAI0B,MAAO,CAChBC,SAAU,WACV,IAAO,EACP,OAAU,EACV,KAAQ,EACR,MAAS,EACT9B,MAAOH,EAAMG,MACbC,OAAQJ,EAAMI,aAIlC,C;;;;;;AC9EA,IAAI+B,EAAwBf,OAAOe,sBAC/BC,EAAiBhB,OAAOiB,UAAUD,eAClCE,EAAmBlB,OAAOiB,UAAUE,qBAsDxCC,EAAOC,QA5CP,WACC,IACC,IAAKrB,OAAOC,OACX,OAAO,EAMR,IAAIqB,EAAQ,IAAIC,OAAO,OAEvB,GADAD,EAAM,GAAK,KACkC,MAAzCtB,OAAOwB,oBAAoBF,GAAO,GACrC,OAAO,EAKR,IADA,IAAIG,EAAQ,CAAC,EACJC,EAAI,EAAGA,EAAI,GAAIA,IACvBD,EAAM,IAAMF,OAAOI,aAAaD,IAAMA,EAKvC,GAAwB,eAHX1B,OAAOwB,oBAAoBC,GAAOG,KAAI,SAAUC,GAC5D,OAAOJ,EAAMI,EACd,IACWC,KAAK,IACf,OAAO,EAIR,IAAIC,EAAQ,CAAC,EAIb,MAHA,uBAAuBtC,MAAM,IAAIuC,SAAQ,SAAUC,GAClDF,EAAME,GAAUA,CACjB,IAEE,yBADEjC,OAAOkC,KAAKlC,OAAOC,OAAO,CAAC,EAAG8B,IAAQD,KAAK,GAMhD,CAAE,MAAOK,GAER,OAAO,CACR,CACD,CAEiBC,GAAoBpC,OAAOC,OAAS,SAAUoC,EAAQC,GAKtE,IAJA,IAAIC,EAEAC,EADAC,EAtDL,SAAkBC,GACjB,GAAIA,QACH,MAAM,IAAIC,UAAU,yDAGrB,OAAO3C,OAAO0C,EACf,CAgDUE,CAASP,GAGTQ,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAG1C,IAAK,IAAIG,KAFTT,EAAOvC,OAAO8C,UAAUD,IAGnB7B,EAAeiC,KAAKV,EAAMS,KAC7BP,EAAGO,GAAOT,EAAKS,IAIjB,GAAIjC,EAAuB,CAC1ByB,EAAUzB,EAAsBwB,GAChC,IAAK,IAAIb,EAAI,EAAGA,EAAIc,EAAQO,OAAQrB,IAC/BR,EAAiB+B,KAAKV,EAAMC,EAAQd,MACvCe,EAAGD,EAAQd,IAAMa,EAAKC,EAAQd,IAGjC,CACD,CAEA,OAAOe,CACR,C;;;;;;;;;ACjFa,EAAQ,KAAiB,IAAIS,EAAE,EAAQ,KAASC,EAAE,MAA6B,GAAvB9B,EAAQ+B,SAAS,MAAS,mBAAoBC,QAAQA,OAAOC,IAAI,CAAC,IAAIC,EAAEF,OAAOC,IAAIH,EAAEI,EAAE,iBAAiBlC,EAAQ+B,SAASG,EAAE,iBAAiB,CAAC,IAAIC,EAAEN,EAAEO,mDAAmDC,kBAAkB7B,EAAE7B,OAAOiB,UAAUD,eAAe2C,EAAE,CAACX,KAAI,EAAGY,KAAI,EAAGC,QAAO,EAAGC,UAAS,GACrW,SAASC,EAAEC,EAAEC,EAAEC,GAAG,IAAIC,EAAEC,EAAE,CAAC,EAAEC,EAAE,KAAKC,EAAE,KAAiF,IAAIH,UAAhF,IAASD,IAAIG,EAAE,GAAGH,QAAG,IAASD,EAAEjB,MAAMqB,EAAE,GAAGJ,EAAEjB,UAAK,IAASiB,EAAEL,MAAMU,EAAEL,EAAEL,KAAcK,EAAEpC,EAAEoB,KAAKgB,EAAEE,KAAKR,EAAE3C,eAAemD,KAAKC,EAAED,GAAGF,EAAEE,IAAI,GAAGH,GAAGA,EAAEO,aAAa,IAAIJ,KAAKF,EAAED,EAAEO,kBAAe,IAASH,EAAED,KAAKC,EAAED,GAAGF,EAAEE,IAAI,MAAM,CAACK,SAASrB,EAAEsB,KAAKT,EAAEhB,IAAIqB,EAAET,IAAIU,EAAE5F,MAAM0F,EAAEM,OAAOlB,EAAEmB,QAAQ,CAACtD,EAAQuD,IAAIb,C,gBCNtU3C,EAAOC,QAAU,EAAjB,G","sources":["webpack://TopWritePlugins.youku/./.topwrite/use-config.ts","webpack://TopWritePlugins.youku/./src/lib/parse-content.ts","webpack://TopWritePlugins.youku/./src/components/youku.tsx","webpack://TopWritePlugins.youku/../../../topteam/write/packages/node_modules/.pnpm/object-assign@4.1.1/node_modules/object-assign/index.js","webpack://TopWritePlugins.youku/../../../topteam/write/packages/node_modules/.pnpm/react@17.0.2/node_modules/react/cjs/react-jsx-runtime.production.min.js","webpack://TopWritePlugins.youku/../../../topteam/write/packages/node_modules/.pnpm/react@17.0.2/node_modules/react/jsx-runtime.js"],"sourcesContent":["import { BaseConfig, Config, useBook } from 'topwrite';\r\nimport { Config as ConfigType } from './config';\r\n\r\ndeclare const PLUGIN_NAME: string;\r\n\r\ndeclare module 'topwrite' {\r\n    export interface HookContext {\r\n        getConfig(): BaseConfig<ConfigType>;\r\n    }\r\n}\r\n\r\nexport function getPluginConfig(config: Config): BaseConfig<ConfigType> {\r\n\r\n    const schema = require('../config.json');\r\n\r\n    return config.getPluginConfig(PLUGIN_NAME, schema);\r\n}\r\n\r\nexport default function useConfig() {\r\n    const { config } = useBook();\r\n\r\n    return getPluginConfig(config);\r\n};\r\n","const PATTERN = /(\\w+)\\s=(\\d*)x(\\d*)/;\r\n\r\nexport default function parseContent(text: string) {\r\n    let\r\n        [id, password] = text.trim().split('\\n'),\r\n        result = PATTERN.exec(id),\r\n        width, height;\r\n\r\n    if (result) {\r\n        id = result[1];\r\n        width = parseInt(result[2]) || 'auto';\r\n        height = parseInt(result[3]) || 'auto';\r\n    }\r\n\r\n    return { id, width, height, password };\r\n}\r\n","import { GetComponentProps, loadjs } from 'topwrite';\r\nimport { useEffect, useMemo, useState } from 'react';\r\nimport parseContent from '@/lib/parse-content';\r\nimport useConfig from '@@/use-config';\r\n\r\ndeclare global {\r\n    interface Window {\r\n        YKU: any;\r\n    }\r\n}\r\n\r\ninterface State {\r\n    width?: string | number;\r\n    height?: string | number;\r\n    resize: boolean;\r\n    options?: {\r\n        vid: string;\r\n        password?: string\r\n    };\r\n}\r\n\r\nlet YKID = 0;\r\nlet LOADED = false;\r\n\r\nexport default function Youku({ props: { value } }: GetComponentProps<'x-block'>) {\r\n    const config = useConfig();\r\n    const [state, setState] = useState<State>({\r\n        width: 2,\r\n        height: 2,\r\n        resize: false\r\n    });\r\n\r\n    const id = useMemo(() => `youku-${++YKID}`, []);\r\n\r\n    useEffect(() => {\r\n        if (!LOADED) {\r\n            LOADED = true;\r\n            loadjs('https://player.youku.com/jsapi', 'youku');\r\n        }\r\n\r\n        loadjs.ready('youku', () => {\r\n            let { id, width, height, password } = parseContent(value);\r\n\r\n            let options: State['options'] = {\r\n                vid: id\r\n            };\r\n\r\n            password && (options.password = password);\r\n\r\n            options = Object.assign({\r\n                styleid: '0',\r\n                client_id: '70425dd755d80061',\r\n                newPlayer: true\r\n            }, config.getValues(), options);\r\n\r\n            if (width || height) {\r\n                setState({ width, height, resize: true, options });\r\n            } else {\r\n                setState({ width: '100%', height: '100%', resize: false, options });\r\n            }\r\n        });\r\n    }, [value]);\r\n\r\n    useEffect(() => {\r\n        if (state.options) {\r\n            new window.YKU.Player(id, state.options);\r\n        }\r\n    }, [state.options]);\r\n\r\n    return <>\r\n        {state.resize ? <div id={id} style={{\r\n                width: state.width,\r\n                height: state.height\r\n            }} /> :\r\n            <div style={{ position: 'relative', width: '100%', height: 0, paddingBottom: '56.25%' }}>\r\n                <div id={id} style={{\r\n                    position: 'absolute',\r\n                    'top': 0,\r\n                    'bottom': 0,\r\n                    'left': 0,\r\n                    'right': 0,\r\n                    width: state.width,\r\n                    height: state.height\r\n                }} />\r\n            </div>}\r\n    </>;\r\n}\r\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","/** @license React v17.0.2\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';require(\"object-assign\");var f=require(\"react\"),g=60103;exports.Fragment=60107;if(\"function\"===typeof Symbol&&Symbol.for){var h=Symbol.for;g=h(\"react.element\");exports.Fragment=h(\"react.fragment\")}var m=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n=Object.prototype.hasOwnProperty,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,k){var b,d={},e=null,l=null;void 0!==k&&(e=\"\"+k);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(l=a.ref);for(b in a)n.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:g,type:c,key:e,ref:l,props:d,_owner:m.current}}exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n"],"names":["useConfig","config","useBook","schema","require","getPluginConfig","PLUGIN_NAME","PATTERN","YKID","LOADED","Youku","_ref","props","value","state","setState","useState","width","height","resize","id","useMemo","useEffect","loadjs","password","text","trim","split","result","exec","parseInt","parseContent","options","vid","Object","assign","styleid","client_id","newPlayer","getValues","window","YKU","Player","_jsx","_Fragment","children","style","position","paddingBottom","getOwnPropertySymbols","hasOwnProperty","prototype","propIsEnumerable","propertyIsEnumerable","module","exports","test1","String","getOwnPropertyNames","test2","i","fromCharCode","map","n","join","test3","forEach","letter","keys","err","shouldUseNative","target","source","from","symbols","to","val","TypeError","toObject","s","arguments","length","key","call","f","g","Fragment","Symbol","for","h","m","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentOwner","p","ref","__self","__source","q","c","a","k","b","d","e","l","defaultProps","$$typeof","type","_owner","current","jsx"],"sourceRoot":""}